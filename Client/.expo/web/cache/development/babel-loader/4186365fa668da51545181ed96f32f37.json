{"ast":null,"code":"\"use strict\";\n/**\n * @license\n * Copyright Akveo. All Rights Reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n */\n\nvar _toConsumableArray = require(\"@babel/runtime/helpers/toConsumableArray\");\n\nvar _defineProperty = require(\"@babel/runtime/helpers/defineProperty\");\n\nvar _classCallCheck = require(\"@babel/runtime/helpers/classCallCheck\");\n\nvar _createClass = require(\"@babel/runtime/helpers/createClass\");\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar date_service_1 = require(\"./date.service\");\n\nvar helpers_1 = require(\"./helpers\");\n\nvar DEFAULT_DATE_OPTIONS = {\n  bounding: false,\n  holiday: false,\n  range: false\n};\n\nvar CalendarDataService = function () {\n  function CalendarDataService(dateService) {\n    var _this = this;\n\n    _classCallCheck(this, CalendarDataService);\n\n    this.dateService = dateService;\n\n    this.createDayPickerData = function (date, dateRange) {\n      var weeks = _this.createDates(date, DEFAULT_DATE_OPTIONS, dateRange);\n\n      return _this.withBoundingMonths(weeks, date);\n    };\n\n    this.createMonthPickerData = function (date, rows, columns) {\n      var yearStart = _this.dateService.getYearStart(date);\n\n      var monthRange = helpers_1.range(rows * columns, function (index) {\n        var monthDate = _this.dateService.addMonth(yearStart, index);\n\n        return _objectSpread({\n          date: monthDate\n        }, DEFAULT_DATE_OPTIONS);\n      });\n      return helpers_1.batch(monthRange, rows);\n    };\n\n    this.createYearPickerData = function (date, rows, columns) {\n      var yearStart = _this.dateService.getYearStart(date);\n\n      var yearRange = helpers_1.range(rows * columns, function (index) {\n        var yearDate = _this.dateService.addYear(yearStart, index);\n\n        return _objectSpread({\n          date: yearDate\n        }, DEFAULT_DATE_OPTIONS);\n      });\n      return helpers_1.batch(yearRange, rows);\n    };\n\n    this.createDayPickerPagerData = function (startDate, endDate) {\n      var numberOfDayPickers = _this.getNumberOfMonths(startDate, endDate) + 1;\n      return helpers_1.range(numberOfDayPickers, function (index) {\n        var monthDate = _this.dateService.addMonth(startDate, index);\n\n        return _objectSpread({\n          date: monthDate\n        }, DEFAULT_DATE_OPTIONS);\n      });\n    };\n\n    this.createYearPickerPagerData = function (startDate, endDate, rows, columns) {\n      var numberOfYears = _this.getNumberOfYears(startDate, endDate) + 1;\n      var numberOfYearPickers = Math.max(Math.ceil(numberOfYears / (rows * columns)), 1);\n      return helpers_1.range(numberOfYearPickers, function (index) {\n        var yearDate = _this.dateService.addYear(startDate, index * rows * columns);\n\n        return _objectSpread({\n          date: yearDate\n        }, DEFAULT_DATE_OPTIONS);\n      });\n    };\n\n    this.getNumberOfMonths = function (lhs, rhs) {\n      var numberOfYears = _this.getNumberOfYears(lhs, rhs);\n\n      var numberOfMonths = _this.dateService.getMonth(rhs) - _this.dateService.getMonth(lhs);\n\n      return numberOfMonths + numberOfYears * date_service_1.DateService.MONTHS_IN_YEAR;\n    };\n\n    this.getNumberOfYears = function (lhs, rhs) {\n      return _this.dateService.getYear(rhs) - _this.dateService.getYear(lhs);\n    };\n  }\n\n  _createClass(CalendarDataService, [{\n    key: \"createDates\",\n    value: function createDates(activeMonth, options, dateRange) {\n      var days = this.createDateRangeForMonth(activeMonth, options);\n\n      if (dateRange) {\n        days = this.withRangedDates(days, dateRange);\n      }\n\n      var startOfWeekDayDiff = this.getStartOfWeekDayDiff(activeMonth);\n      return helpers_1.batch(days, date_service_1.DateService.DAYS_IN_WEEK, startOfWeekDayDiff);\n    }\n  }, {\n    key: \"withRangedDates\",\n    value: function withRangedDates(days, calendarRange) {\n      if (calendarRange.startDate && !calendarRange.endDate) {\n        return this.withRangedStartDates(days, calendarRange.startDate);\n      }\n\n      if (calendarRange.startDate && calendarRange.endDate) {\n        return this.withRangedStartEndDates(days, calendarRange.startDate, calendarRange.endDate);\n      }\n\n      return days;\n    }\n  }, {\n    key: \"withRangedStartDates\",\n    value: function withRangedStartDates(days, startDate) {\n      var _this2 = this;\n\n      return days.map(function (day) {\n        var isSameStartDate = _this2.dateService.compareDatesSafe(day.date, startDate) === 0;\n        return isSameStartDate ? _objectSpread(_objectSpread({}, day), {}, {\n          range: true\n        }) : day;\n      });\n    }\n  }, {\n    key: \"withRangedStartEndDates\",\n    value: function withRangedStartEndDates(days, startDate, endDate) {\n      var _this3 = this;\n\n      return days.map(function (day) {\n        var isSameStartDate = _this3.dateService.compareDatesSafe(day.date, startDate) === 0;\n        var isSameEndDate = _this3.dateService.compareDatesSafe(day.date, endDate) === 0;\n\n        if (isSameStartDate || isSameEndDate) {\n          return _objectSpread(_objectSpread({}, day), {}, {\n            range: true\n          });\n        } else {\n          var isInRange = _this3.dateService.isBetween(day.date, startDate, endDate);\n\n          return _objectSpread(_objectSpread({}, day), {}, {\n            range: isInRange\n          });\n        }\n      });\n    }\n  }, {\n    key: \"withBoundingMonths\",\n    value: function withBoundingMonths(weeks, activeMonth) {\n      var withBoundingMonths = weeks;\n\n      if (this.isShouldAddPrevBoundingMonth(withBoundingMonths)) {\n        withBoundingMonths = this.addPrevBoundingMonth(withBoundingMonths, activeMonth);\n      }\n\n      if (this.isShouldAddNextBoundingMonth(withBoundingMonths)) {\n        withBoundingMonths = this.addNextBoundingMonth(withBoundingMonths, activeMonth);\n      }\n\n      return withBoundingMonths;\n    }\n  }, {\n    key: \"addPrevBoundingMonth\",\n    value: function addPrevBoundingMonth(weeks, activeMonth) {\n      var firstWeek = weeks.shift();\n      var numberOfBoundingDates = date_service_1.DateService.DAYS_IN_WEEK - firstWeek.length;\n      firstWeek.unshift.apply(firstWeek, _toConsumableArray(this.createPrevBoundingDays(activeMonth, numberOfBoundingDates)));\n      return [firstWeek].concat(_toConsumableArray(weeks));\n    }\n  }, {\n    key: \"addNextBoundingMonth\",\n    value: function addNextBoundingMonth(weeks, activeMonth) {\n      var lastWeek = weeks.pop();\n      var numberOfBoundingDates = date_service_1.DateService.DAYS_IN_WEEK - lastWeek.length;\n      lastWeek.push.apply(lastWeek, _toConsumableArray(this.createNextBoundingDays(activeMonth, numberOfBoundingDates)));\n      return [].concat(_toConsumableArray(weeks), [lastWeek]);\n    }\n  }, {\n    key: \"createPrevBoundingDays\",\n    value: function createPrevBoundingDays(activeMonth, numberOfBoundingDates) {\n      var month = this.dateService.addMonth(activeMonth, -1);\n      var daysInMonth = this.dateService.getNumberOfDaysInMonth(month);\n      return this.createDateRangeForMonth(month, DEFAULT_DATE_OPTIONS).slice(daysInMonth - numberOfBoundingDates).map(function (date) {\n        return _objectSpread(_objectSpread({}, date), {}, {\n          bounding: true\n        });\n      });\n    }\n  }, {\n    key: \"createNextBoundingDays\",\n    value: function createNextBoundingDays(activeMonth, numberOfBoundingDates) {\n      var month = this.dateService.addMonth(activeMonth, 1);\n      return this.createDateRangeForMonth(month, DEFAULT_DATE_OPTIONS).slice(0, numberOfBoundingDates).map(function (date) {\n        return _objectSpread(_objectSpread({}, date), {}, {\n          bounding: true\n        });\n      });\n    }\n  }, {\n    key: \"getStartOfWeekDayDiff\",\n    value: function getStartOfWeekDayDiff(date) {\n      var startOfMonth = this.dateService.getMonthStart(date);\n      return this.getWeekStartDiff(startOfMonth);\n    }\n  }, {\n    key: \"getWeekStartDiff\",\n    value: function getWeekStartDiff(date) {\n      return (date_service_1.DateService.DAYS_IN_WEEK - this.dateService.getFirstDayOfWeek() + this.dateService.getDayOfWeek(date)) % date_service_1.DateService.DAYS_IN_WEEK;\n    }\n  }, {\n    key: \"isShouldAddPrevBoundingMonth\",\n    value: function isShouldAddPrevBoundingMonth(weeks) {\n      return weeks[0].length < date_service_1.DateService.DAYS_IN_WEEK;\n    }\n  }, {\n    key: \"isShouldAddNextBoundingMonth\",\n    value: function isShouldAddNextBoundingMonth(weeks) {\n      return weeks[weeks.length - 1].length < date_service_1.DateService.DAYS_IN_WEEK;\n    }\n  }, {\n    key: \"createDateRangeForMonth\",\n    value: function createDateRangeForMonth(monthDate, options) {\n      var _this4 = this;\n\n      var daysInMonth = this.dateService.getNumberOfDaysInMonth(monthDate);\n      return helpers_1.range(daysInMonth, function (i) {\n        var year = _this4.dateService.getYear(monthDate);\n\n        var month = _this4.dateService.getMonth(monthDate);\n\n        var date = _this4.dateService.createDate(year, month, i + 1);\n\n        return _objectSpread({\n          date: date\n        }, options);\n      });\n    }\n  }]);\n\n  return CalendarDataService;\n}();\n\nexports.CalendarDataService = CalendarDataService;","map":{"version":3,"sources":["../../../../../../src/components/ui/calendar/service/calendarData.service.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\n/**\n * @license\n * Copyright Akveo. All Rights Reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst date_service_1 = require(\"./date.service\");\nconst helpers_1 = require(\"./helpers\");\nconst DEFAULT_DATE_OPTIONS = {\n    bounding: false,\n    holiday: false,\n    range: false,\n};\nclass CalendarDataService {\n    constructor(dateService) {\n        this.dateService = dateService;\n        this.createDayPickerData = (date, dateRange) => {\n            const weeks = this.createDates(date, DEFAULT_DATE_OPTIONS, dateRange);\n            return this.withBoundingMonths(weeks, date);\n        };\n        this.createMonthPickerData = (date, rows, columns) => {\n            const yearStart = this.dateService.getYearStart(date);\n            const monthRange = helpers_1.range(rows * columns, (index) => {\n                const monthDate = this.dateService.addMonth(yearStart, index);\n                return { date: monthDate, ...DEFAULT_DATE_OPTIONS };\n            });\n            return helpers_1.batch(monthRange, rows);\n        };\n        this.createYearPickerData = (date, rows, columns) => {\n            const yearStart = this.dateService.getYearStart(date);\n            const yearRange = helpers_1.range(rows * columns, (index) => {\n                const yearDate = this.dateService.addYear(yearStart, index);\n                return { date: yearDate, ...DEFAULT_DATE_OPTIONS };\n            });\n            return helpers_1.batch(yearRange, rows);\n        };\n        this.createDayPickerPagerData = (startDate, endDate) => {\n            const numberOfDayPickers = this.getNumberOfMonths(startDate, endDate) + 1;\n            return helpers_1.range(numberOfDayPickers, (index) => {\n                const monthDate = this.dateService.addMonth(startDate, index);\n                return { date: monthDate, ...DEFAULT_DATE_OPTIONS };\n            });\n        };\n        this.createYearPickerPagerData = (startDate, endDate, rows, columns) => {\n            const numberOfYears = this.getNumberOfYears(startDate, endDate) + 1;\n            const numberOfYearPickers = Math.max(Math.ceil(numberOfYears / (rows * columns)), 1);\n            return helpers_1.range(numberOfYearPickers, (index) => {\n                const yearDate = this.dateService.addYear(startDate, index * rows * columns);\n                return { date: yearDate, ...DEFAULT_DATE_OPTIONS };\n            });\n        };\n        this.getNumberOfMonths = (lhs, rhs) => {\n            const numberOfYears = this.getNumberOfYears(lhs, rhs);\n            const numberOfMonths = this.dateService.getMonth(rhs) - this.dateService.getMonth(lhs);\n            return numberOfMonths + numberOfYears * date_service_1.DateService.MONTHS_IN_YEAR;\n        };\n        this.getNumberOfYears = (lhs, rhs) => {\n            return this.dateService.getYear(rhs) - this.dateService.getYear(lhs);\n        };\n    }\n    createDates(activeMonth, options, dateRange) {\n        let days = this.createDateRangeForMonth(activeMonth, options);\n        if (dateRange) {\n            days = this.withRangedDates(days, dateRange);\n        }\n        const startOfWeekDayDiff = this.getStartOfWeekDayDiff(activeMonth);\n        return helpers_1.batch(days, date_service_1.DateService.DAYS_IN_WEEK, startOfWeekDayDiff);\n    }\n    withRangedDates(days, calendarRange) {\n        if (calendarRange.startDate && !calendarRange.endDate) {\n            return this.withRangedStartDates(days, calendarRange.startDate);\n        }\n        if (calendarRange.startDate && calendarRange.endDate) {\n            return this.withRangedStartEndDates(days, calendarRange.startDate, calendarRange.endDate);\n        }\n        return days;\n    }\n    withRangedStartDates(days, startDate) {\n        return days.map((day) => {\n            const isSameStartDate = this.dateService.compareDatesSafe(day.date, startDate) === 0;\n            return isSameStartDate ? { ...day, range: true } : day;\n        });\n    }\n    withRangedStartEndDates(days, startDate, endDate) {\n        return days.map((day) => {\n            const isSameStartDate = this.dateService.compareDatesSafe(day.date, startDate) === 0;\n            const isSameEndDate = this.dateService.compareDatesSafe(day.date, endDate) === 0;\n            if (isSameStartDate || isSameEndDate) {\n                return { ...day, range: true };\n            }\n            else {\n                const isInRange = this.dateService.isBetween(day.date, startDate, endDate);\n                return { ...day, range: isInRange };\n            }\n        });\n    }\n    withBoundingMonths(weeks, activeMonth) {\n        let withBoundingMonths = weeks;\n        if (this.isShouldAddPrevBoundingMonth(withBoundingMonths)) {\n            withBoundingMonths = this.addPrevBoundingMonth(withBoundingMonths, activeMonth);\n        }\n        if (this.isShouldAddNextBoundingMonth(withBoundingMonths)) {\n            withBoundingMonths = this.addNextBoundingMonth(withBoundingMonths, activeMonth);\n        }\n        return withBoundingMonths;\n    }\n    addPrevBoundingMonth(weeks, activeMonth) {\n        const firstWeek = weeks.shift();\n        const numberOfBoundingDates = date_service_1.DateService.DAYS_IN_WEEK - firstWeek.length;\n        firstWeek.unshift(...this.createPrevBoundingDays(activeMonth, numberOfBoundingDates));\n        return [firstWeek, ...weeks];\n    }\n    addNextBoundingMonth(weeks, activeMonth) {\n        const lastWeek = weeks.pop();\n        const numberOfBoundingDates = date_service_1.DateService.DAYS_IN_WEEK - lastWeek.length;\n        lastWeek.push(...this.createNextBoundingDays(activeMonth, numberOfBoundingDates));\n        return [...weeks, lastWeek];\n    }\n    createPrevBoundingDays(activeMonth, numberOfBoundingDates) {\n        const month = this.dateService.addMonth(activeMonth, -1);\n        const daysInMonth = this.dateService.getNumberOfDaysInMonth(month);\n        return this.createDateRangeForMonth(month, DEFAULT_DATE_OPTIONS)\n            .slice(daysInMonth - numberOfBoundingDates)\n            .map((date) => {\n            return { ...date, bounding: true };\n        });\n    }\n    createNextBoundingDays(activeMonth, numberOfBoundingDates) {\n        const month = this.dateService.addMonth(activeMonth, 1);\n        return this.createDateRangeForMonth(month, DEFAULT_DATE_OPTIONS)\n            .slice(0, numberOfBoundingDates)\n            .map((date) => {\n            return { ...date, bounding: true };\n        });\n    }\n    getStartOfWeekDayDiff(date) {\n        const startOfMonth = this.dateService.getMonthStart(date);\n        return this.getWeekStartDiff(startOfMonth);\n    }\n    getWeekStartDiff(date) {\n        return (date_service_1.DateService.DAYS_IN_WEEK\n            - this.dateService.getFirstDayOfWeek()\n            + this.dateService.getDayOfWeek(date)) % date_service_1.DateService.DAYS_IN_WEEK;\n    }\n    isShouldAddPrevBoundingMonth(weeks) {\n        return weeks[0].length < date_service_1.DateService.DAYS_IN_WEEK;\n    }\n    isShouldAddNextBoundingMonth(weeks) {\n        return weeks[weeks.length - 1].length < date_service_1.DateService.DAYS_IN_WEEK;\n    }\n    createDateRangeForMonth(monthDate, options) {\n        const daysInMonth = this.dateService.getNumberOfDaysInMonth(monthDate);\n        return helpers_1.range(daysInMonth, (i) => {\n            const year = this.dateService.getYear(monthDate);\n            const month = this.dateService.getMonth(monthDate);\n            const date = this.dateService.createDate(year, month, i + 1);\n            return { date, ...options };\n        });\n    }\n}\nexports.CalendarDataService = CalendarDataService;\n//# sourceMappingURL=calendarData.service.js.map"]},"metadata":{},"sourceType":"script"}